[0m14:53:44.596175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2D11F8DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2D109AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2D15A5650>]}


============================== 14:53:44.600181 | a9aa1a2e-97c5-451b-9921-5306add7121a ==============================
[0m14:53:44.600181 [info ] [MainThread]: Running with dbt=1.7.17
[0m14:53:44.600181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'N:\\BigData\\Online_Retail_Analysis\\include\\dbt', 'log_path': 'N:\\BigData\\Online_Retail_Analysis\\include\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:53:44.610140 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'online_retail_project'
[0m14:53:44.612372 [debug] [MainThread]: Command `dbt run` failed at 14:53:44.612372 after 0.09 seconds
[0m14:53:44.613868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2D15A5ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2D15A6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2CABB0790>]}
[0m14:53:44.613868 [debug] [MainThread]: Flushing usage events
[0m14:59:11.752366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC20D4BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC2118C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC211A190>]}


============================== 14:59:11.760533 | 3eea39f8-51ff-412b-b2a5-e6ff8adf6650 ==============================
[0m14:59:11.760533 [info ] [MainThread]: Running with dbt=1.7.17
[0m14:59:11.760533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'N:\\BigData\\Online_Retail_Analysis\\include\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'N:\\BigData\\Online_Retail_Analysis\\include\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:59:12.920226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eea39f8-51ff-412b-b2a5-e6ff8adf6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC2A26250>]}
[0m14:59:13.000212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3eea39f8-51ff-412b-b2a5-e6ff8adf6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC29D2D10>]}
[0m14:59:13.005790 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m14:59:13.030481 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m14:59:13.036085 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:59:13.037266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3eea39f8-51ff-412b-b2a5-e6ff8adf6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC2AADE10>]}
[0m14:59:16.391887 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform
[0m14:59:16.400537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3eea39f8-51ff-412b-b2a5-e6ff8adf6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC2B697D0>]}
[0m14:59:16.434548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3eea39f8-51ff-412b-b2a5-e6ff8adf6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC3D46050>]}
[0m14:59:16.435552 [info ] [MainThread]: Found 5 models, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:59:16.438297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eea39f8-51ff-412b-b2a5-e6ff8adf6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC2C89E10>]}
[0m14:59:16.440418 [info ] [MainThread]: 
[0m14:59:16.443246 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:59:16.445461 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online-retail-kaggle'
[0m14:59:16.461680 [debug] [ThreadPool]: Using sqlserver connection "list_online-retail-kaggle"
[0m14:59:16.461680 [debug] [ThreadPool]: On list_online-retail-kaggle: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "connection_name": "list_online-retail-kaggle"} */
select  name as [schema]
    from sys.schemas 
  
[0m14:59:16.461680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:16.461680 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m14:59:18.650740 [debug] [ThreadPool]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m14:59:18.887811 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m14:59:18.890001 [debug] [ThreadPool]: On list_online-retail-kaggle: Close
[0m14:59:18.890511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online-retail-kaggle, now create_online-retail-kaggle_DWH_DWH)
[0m14:59:18.890511 [debug] [ThreadPool]: Creating schema "database: "online-retail-kaggle"
schema: "DWH_DWH"
"
[0m14:59:18.897587 [debug] [ThreadPool]: Using sqlserver connection "create_online-retail-kaggle_DWH_DWH"
[0m14:59:18.899099 [debug] [ThreadPool]: On create_online-retail-kaggle_DWH_DWH: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "connection_name": "create_online-retail-kaggle_DWH_DWH"} */
USE [online-retail-kaggle];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'DWH_DWH')
    BEGIN
    EXEC('CREATE SCHEMA [DWH_DWH]')
    END
  
[0m14:59:18.900359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:18.900359 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m14:59:18.900359 [debug] [ThreadPool]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m14:59:19.161023 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:59:19.161023 [debug] [ThreadPool]: On create_online-retail-kaggle_DWH_DWH: COMMIT
[0m14:59:19.168507 [debug] [ThreadPool]: On create_online-retail-kaggle_DWH_DWH: Close
[0m14:59:19.170776 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online-retail-kaggle_DWH_DWH'
[0m14:59:19.170776 [debug] [ThreadPool]: Using sqlserver connection "list_online-retail-kaggle_DWH_DWH"
[0m14:59:19.170776 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH_DWH: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "connection_name": "list_online-retail-kaggle_DWH_DWH"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH_DWH'
  
[0m14:59:19.170776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:19.170776 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m14:59:19.170776 [debug] [ThreadPool]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m14:59:19.414193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:59:19.420871 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH_DWH: ROLLBACK
[0m14:59:19.420871 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH_DWH: Close
[0m14:59:19.420871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_online-retail-kaggle_DWH_DWH, now list_online-retail-kaggle_DWH)
[0m14:59:19.420871 [debug] [ThreadPool]: Using sqlserver connection "list_online-retail-kaggle_DWH"
[0m14:59:19.420871 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "connection_name": "list_online-retail-kaggle_DWH"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH'
  
[0m14:59:19.426317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:19.426317 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m14:59:19.427867 [debug] [ThreadPool]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m14:59:19.667117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:59:19.670650 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: ROLLBACK
[0m14:59:19.670826 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: Close
[0m14:59:19.670826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eea39f8-51ff-412b-b2a5-e6ff8adf6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC2A258D0>]}
[0m14:59:19.670826 [debug] [MainThread]: On master: COMMIT
[0m14:59:19.670826 [info ] [MainThread]: Concurrency: 1 threads (target='dwh')
[0m14:59:19.670826 [info ] [MainThread]: 
[0m14:59:19.683686 [debug] [Thread-1 (]: Began running node model.online_retail_project.dim_country
[0m14:59:19.684821 [info ] [Thread-1 (]: 1 of 1 START sql table model DWH_DWH.dim_country ............................... [RUN]
[0m14:59:19.686187 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_retail_project.dim_country'
[0m14:59:19.687388 [debug] [Thread-1 (]: Began compiling node model.online_retail_project.dim_country
[0m14:59:19.690392 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_retail_project.dim_country"
[0m14:59:19.700539 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dim_country (compile): 14:59:19.688397 => 14:59:19.700539
[0m14:59:19.703535 [debug] [Thread-1 (]: Began executing node model.online_retail_project.dim_country
[0m14:59:19.731673 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dim_country"
[0m14:59:19.735725 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dim_country"} */

      
      
    USE [online-retail-kaggle];
    EXEC('DROP table IF EXISTS "DWH_DWH"."dim_country__dbt_backup";');

[0m14:59:19.736746 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:19.736746 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m14:59:19.737732 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m14:59:19.968011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:59:19.970427 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dim_country"
[0m14:59:19.975434 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dim_country"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH_DWH'
    and table_name like 'dim_country'
  
[0m14:59:20.215329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:59:20.241921 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dim_country"
[0m14:59:20.242981 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dim_country"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH_DWH'
      and refs.referenced_entity_name = 'dim_country_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:59:20.492823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:59:20.492823 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dim_country"
[0m14:59:20.492823 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dim_country"} */

    
      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH_DWH"."dim_country_temp_view";');

  
[0m14:59:20.727573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:59:20.730697 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dim_country"
[0m14:59:20.730697 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dim_country"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH_DWH'
      and refs.referenced_entity_name = 'dim_country_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m14:59:20.961635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:59:20.961635 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_retail_project.dim_country"
[0m14:59:20.965809 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dim_country"
[0m14:59:20.965809 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dim_country"} */

  
    

   

    USE [online-retail-kaggle];
    
    

    EXEC('create view "DWH_DWH"."dim_country_temp_view" as 

SELECT
    *
FROM
    "online-retail-kaggle"."dbo"."country";');



    
      EXEC('SELECT * INTO [online-retail-kaggle].[DWH_DWH].[dim_country] FROM [online-retail-kaggle].[DWH_DWH].[dim_country_temp_view];');
    

    
      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH_DWH"."dim_country_temp_view";');



  
[0m14:59:21.229078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:59:21.240392 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: COMMIT
[0m14:59:21.245415 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dim_country"
[0m14:59:21.245415 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dim_country"} */

      USE [online-retail-kaggle];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'DWH_DWH' and tab2.name = 'dim_country__dbt_backup'
  
[0m14:59:22.070660 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:59:22.070660 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dim_country"
[0m14:59:22.076415 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dim_country"} */

      
      
    USE [online-retail-kaggle];
    EXEC('DROP table IF EXISTS "DWH_DWH"."dim_country__dbt_backup";');

[0m14:59:22.300465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:59:22.310543 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dim_country (execute): 14:59:19.703535 => 14:59:22.310543
[0m14:59:22.310543 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: ROLLBACK
[0m14:59:22.310543 [debug] [Thread-1 (]: On model.online_retail_project.dim_country: Close
[0m14:59:22.310543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3eea39f8-51ff-412b-b2a5-e6ff8adf6650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC2B0D610>]}
[0m14:59:22.315802 [info ] [Thread-1 (]: 1 of 1 OK created sql table model DWH_DWH.dim_country .......................... [[32mOK[0m in 2.62s]
[0m14:59:22.315802 [debug] [Thread-1 (]: Finished running node model.online_retail_project.dim_country
[0m14:59:22.320823 [debug] [MainThread]: On master: COMMIT
[0m14:59:22.321829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:22.321829 [debug] [MainThread]: Connection 'create_online-retail-kaggle_DWH_DWH' was properly closed.
[0m14:59:22.321829 [debug] [MainThread]: Connection 'list_online-retail-kaggle_DWH' was properly closed.
[0m14:59:22.321829 [debug] [MainThread]: Connection 'model.online_retail_project.dim_country' was properly closed.
[0m14:59:22.325458 [info ] [MainThread]: 
[0m14:59:22.325458 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m14:59:22.328248 [debug] [MainThread]: Command end result
[0m14:59:22.339089 [info ] [MainThread]: 
[0m14:59:22.341771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:59:22.341771 [info ] [MainThread]: 
[0m14:59:22.341771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:59:22.347438 [debug] [MainThread]: Command `dbt run` succeeded at 14:59:22.347438 after 10.69 seconds
[0m14:59:22.348444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BBB4CBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC2CA0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BBB774F10>]}
[0m14:59:22.348444 [debug] [MainThread]: Flushing usage events
[0m15:06:21.148929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C699D7B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6BFE8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6BFE8C50>]}


============================== 15:06:21.153756 | 3a2af0ee-28cf-4197-a640-371b1908c710 ==============================
[0m15:06:21.153756 [info ] [MainThread]: Running with dbt=1.7.17
[0m15:06:21.155102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'N:\\BigData\\Online_Retail_Analysis\\include\\dbt', 'log_path': 'N:\\BigData\\Online_Retail_Analysis\\include\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:21.640827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a2af0ee-28cf-4197-a640-371b1908c710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C3EB050>]}
[0m15:06:21.723429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a2af0ee-28cf-4197-a640-371b1908c710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C70FD50>]}
[0m15:06:21.723429 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m15:06:21.740602 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m15:06:21.850686 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m15:06:21.850686 [debug] [MainThread]: Partial parsing: added file: online_retail_project://models\transform\dimDateTime.sql
[0m15:06:21.850686 [debug] [MainThread]: Partial parsing: added file: online_retail_project://models\transform\factInvoice.sql
[0m15:06:21.856418 [debug] [MainThread]: Partial parsing: added file: online_retail_project://models\transform\dimProducts.sql
[0m15:06:21.857435 [debug] [MainThread]: Partial parsing: added file: online_retail_project://models\transform\dimCountry.sql
[0m15:06:21.857854 [debug] [MainThread]: Partial parsing: added file: online_retail_project://models\transform\dimCustomer.sql
[0m15:06:21.857854 [debug] [MainThread]: Partial parsing: deleted file: online_retail_project://models\transform\fact_invoice.sql
[0m15:06:21.857854 [debug] [MainThread]: Partial parsing: deleted file: online_retail_project://models\transform\dim_datetime.sql
[0m15:06:21.857854 [debug] [MainThread]: Partial parsing: deleted file: online_retail_project://models\transform\dim_country.sql
[0m15:06:21.857854 [debug] [MainThread]: Partial parsing: deleted file: online_retail_project://models\transform\dim_products.sql
[0m15:06:21.860973 [debug] [MainThread]: Partial parsing: deleted file: online_retail_project://models\transform\dim_customers.sql
[0m15:06:22.044384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform
[0m15:06:22.053151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a2af0ee-28cf-4197-a640-371b1908c710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6CD76490>]}
[0m15:06:22.070983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a2af0ee-28cf-4197-a640-371b1908c710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6D064890>]}
[0m15:06:22.070983 [info ] [MainThread]: Found 5 models, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:06:22.072489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2af0ee-28cf-4197-a640-371b1908c710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C3EAD10>]}
[0m15:06:22.076753 [info ] [MainThread]: 
[0m15:06:22.079108 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:06:22.080857 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online-retail-kaggle'
[0m15:06:22.091000 [debug] [ThreadPool]: Using sqlserver connection "list_online-retail-kaggle"
[0m15:06:22.091000 [debug] [ThreadPool]: On list_online-retail-kaggle: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "connection_name": "list_online-retail-kaggle"} */
select  name as [schema]
    from sys.schemas 
  
[0m15:06:22.091000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:22.100807 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m15:06:24.250859 [debug] [ThreadPool]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m15:06:24.478005 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m15:06:24.480609 [debug] [ThreadPool]: On list_online-retail-kaggle: Close
[0m15:06:24.483625 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online-retail-kaggle_DWH'
[0m15:06:24.490765 [debug] [ThreadPool]: Using sqlserver connection "list_online-retail-kaggle_DWH"
[0m15:06:24.490765 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "connection_name": "list_online-retail-kaggle_DWH"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH'
  
[0m15:06:24.491616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:24.492627 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m15:06:24.492627 [debug] [ThreadPool]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m15:06:24.724819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:24.726026 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: ROLLBACK
[0m15:06:24.727541 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: Close
[0m15:06:24.729556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2af0ee-28cf-4197-a640-371b1908c710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6CC91F50>]}
[0m15:06:24.730572 [debug] [MainThread]: On master: COMMIT
[0m15:06:24.731150 [info ] [MainThread]: Concurrency: 1 threads (target='dwh')
[0m15:06:24.732169 [info ] [MainThread]: 
[0m15:06:24.737955 [debug] [Thread-1 (]: Began running node model.online_retail_project.dimCountry
[0m15:06:24.738956 [info ] [Thread-1 (]: 1 of 1 START sql view model DWH.dimCountry ..................................... [RUN]
[0m15:06:24.741041 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_retail_project.dimCountry'
[0m15:06:24.741041 [debug] [Thread-1 (]: Began compiling node model.online_retail_project.dimCountry
[0m15:06:24.749123 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_retail_project.dimCountry"
[0m15:06:24.750908 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dimCountry (compile): 15:06:24.742077 => 15:06:24.749858
[0m15:06:24.751932 [debug] [Thread-1 (]: Began executing node model.online_retail_project.dimCountry
[0m15:06:24.780677 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:06:24.780677 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH'
      and refs.referenced_entity_name = 'dimCountry__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:06:24.788752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:06:24.791262 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m15:06:24.791262 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m15:06:25.039667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.041146 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:06:25.042151 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH"."dimCountry__dbt_backup";');

[0m15:06:25.270102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.273517 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:06:25.274530 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH'
    and table_name like 'dimCountry'
  
[0m15:06:25.510726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.520570 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_retail_project.dimCountry"
[0m15:06:25.524979 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:06:25.528179 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */
USE [online-retail-kaggle];
    
    

    EXEC('create view "DWH"."dimCountry" as SELECT
    *
FROM
    "online-retail-kaggle"."dbo"."country";');



[0m15:06:25.783677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.799753 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: COMMIT
[0m15:06:25.801032 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:06:25.801032 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH'
      and refs.referenced_entity_name = 'dimCountry__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:06:26.076282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:26.077479 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:06:26.078052 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH"."dimCountry__dbt_backup";');

[0m15:06:26.301165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:26.301165 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dimCountry (execute): 15:06:24.751932 => 15:06:26.301165
[0m15:06:26.301165 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: ROLLBACK
[0m15:06:26.310494 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: Close
[0m15:06:26.311919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2af0ee-28cf-4197-a640-371b1908c710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6CE07950>]}
[0m15:06:26.312961 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DWH.dimCountry ................................ [[32mOK[0m in 1.57s]
[0m15:06:26.315232 [debug] [Thread-1 (]: Finished running node model.online_retail_project.dimCountry
[0m15:06:26.316239 [debug] [MainThread]: On master: COMMIT
[0m15:06:26.317244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:26.318243 [debug] [MainThread]: Connection 'list_online-retail-kaggle' was properly closed.
[0m15:06:26.319237 [debug] [MainThread]: Connection 'list_online-retail-kaggle_DWH' was properly closed.
[0m15:06:26.319237 [debug] [MainThread]: Connection 'model.online_retail_project.dimCountry' was properly closed.
[0m15:06:26.320758 [info ] [MainThread]: 
[0m15:06:26.321773 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m15:06:26.323501 [debug] [MainThread]: Command end result
[0m15:06:26.338560 [info ] [MainThread]: 
[0m15:06:26.340535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:26.341794 [info ] [MainThread]: 
[0m15:06:26.343115 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:06:26.346608 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:26.343115 after 5.29 seconds
[0m15:06:26.346608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C3EB090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6BE8B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6BE8AF10>]}
[0m15:06:26.347627 [debug] [MainThread]: Flushing usage events
[0m15:34:16.713323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C148032D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C148026290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1480792D0>]}


============================== 15:34:16.722993 | 21d08937-9dda-4dd9-aa83-93b75184ec0a ==============================
[0m15:34:16.722993 [info ] [MainThread]: Running with dbt=1.7.17
[0m15:34:16.722993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'N:\\BigData\\Online_Retail_Analysis\\include\\dbt', 'log_path': 'N:\\BigData\\Online_Retail_Analysis\\include\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:34:17.193082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C147B1B050>]}
[0m15:34:17.262676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1487BB0D0>]}
[0m15:34:17.267690 [info ] [MainThread]: Registered adapter: sqlserver=1.7.4
[0m15:34:17.282681 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m15:34:17.373088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:34:17.382872 [debug] [MainThread]: Partial parsing: updated file: online_retail_project://models\sources\sources.yml
[0m15:34:17.384205 [debug] [MainThread]: Partial parsing: updated file: online_retail_project://models\transform\dimCountry.sql
[0m15:34:17.386230 [debug] [MainThread]: Partial parsing: updated file: online_retail_project://models\transform\dimProducts.sql
[0m15:34:17.386230 [debug] [MainThread]: Partial parsing: updated file: online_retail_project://models\transform\dimCustomer.sql
[0m15:34:17.642610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.transform
[0m15:34:17.655439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C148A96A90>]}
[0m15:34:17.670822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C149DB1390>]}
[0m15:34:17.671390 [info ] [MainThread]: Found 5 models, 2 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:34:17.672990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1488A5650>]}
[0m15:34:17.672990 [info ] [MainThread]: 
[0m15:34:17.672990 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:34:17.672990 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online-retail-kaggle'
[0m15:34:17.695613 [debug] [ThreadPool]: Using sqlserver connection "list_online-retail-kaggle"
[0m15:34:17.697015 [debug] [ThreadPool]: On list_online-retail-kaggle: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "connection_name": "list_online-retail-kaggle"} */
select  name as [schema]
    from sys.schemas 
  
[0m15:34:17.698036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:17.699456 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m15:34:19.833550 [debug] [ThreadPool]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m15:34:20.064595 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m15:34:20.066904 [debug] [ThreadPool]: On list_online-retail-kaggle: Close
[0m15:34:20.069261 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_online-retail-kaggle_DWH'
[0m15:34:20.072965 [debug] [ThreadPool]: Using sqlserver connection "list_online-retail-kaggle_DWH"
[0m15:34:20.072965 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "connection_name": "list_online-retail-kaggle_DWH"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH'
  
[0m15:34:20.072965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:20.072965 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m15:34:20.072965 [debug] [ThreadPool]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m15:34:20.308603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:20.310841 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: ROLLBACK
[0m15:34:20.310841 [debug] [ThreadPool]: On list_online-retail-kaggle_DWH: Close
[0m15:34:20.312970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C148D33210>]}
[0m15:34:20.312970 [debug] [MainThread]: On master: COMMIT
[0m15:34:20.312970 [info ] [MainThread]: Concurrency: 1 threads (target='dwh')
[0m15:34:20.312970 [info ] [MainThread]: 
[0m15:34:20.312970 [debug] [Thread-1 (]: Began running node model.online_retail_project.dimCountry
[0m15:34:20.312970 [info ] [Thread-1 (]: 1 of 3 START sql table model DWH.dimCountry .................................... [RUN]
[0m15:34:20.312970 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.online_retail_project.dimCountry'
[0m15:34:20.312970 [debug] [Thread-1 (]: Began compiling node model.online_retail_project.dimCountry
[0m15:34:20.323030 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_retail_project.dimCountry"
[0m15:34:20.323030 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dimCountry (compile): 15:34:20.312970 => 15:34:20.323030
[0m15:34:20.323030 [debug] [Thread-1 (]: Began executing node model.online_retail_project.dimCountry
[0m15:34:20.366730 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:34:20.367789 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      
      
    USE [online-retail-kaggle];
    EXEC('DROP table IF EXISTS "DWH"."dimCountry__dbt_backup";');

[0m15:34:20.368824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:34:20.371109 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m15:34:20.372630 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m15:34:20.603006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:20.605214 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:34:20.605214 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH'
    and table_name like 'dimCountry'
  
[0m15:34:20.853173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:20.876181 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:34:20.877805 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH'
      and refs.referenced_entity_name = 'dimCountry_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:34:21.123057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:21.123057 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:34:21.123057 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

    
      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH"."dimCountry_temp_view";');

  
[0m15:34:21.356591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:21.365887 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:34:21.365887 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH'
      and refs.referenced_entity_name = 'dimCountry_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:34:21.593365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:21.605281 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_retail_project.dimCountry"
[0m15:34:21.605281 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:34:21.605281 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

  
    

   

    USE [online-retail-kaggle];
    
    

    EXEC('create view "DWH"."dimCountry_temp_view" as 

SELECT
    *
FROM
    "online-retail-kaggle"."dbo"."country";');



    
      EXEC('SELECT * INTO [online-retail-kaggle].[DWH].[dimCountry] FROM [online-retail-kaggle].[DWH].[dimCountry_temp_view];');
    

    
      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH"."dimCountry_temp_view";');



  
[0m15:34:21.892894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:21.907866 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: COMMIT
[0m15:34:21.909430 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:34:21.909430 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      USE [online-retail-kaggle];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'DWH' and tab2.name = 'dimCountry__dbt_backup'
  
[0m15:34:22.685062 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:34:22.692678 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCountry"
[0m15:34:22.692678 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCountry"} */

      
      
    USE [online-retail-kaggle];
    EXEC('DROP table IF EXISTS "DWH"."dimCountry__dbt_backup";');

[0m15:34:22.923055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:22.925788 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dimCountry (execute): 15:34:20.323030 => 15:34:22.925788
[0m15:34:22.929675 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: ROLLBACK
[0m15:34:22.929675 [debug] [Thread-1 (]: On model.online_retail_project.dimCountry: Close
[0m15:34:22.931709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C149D43A10>]}
[0m15:34:22.932852 [info ] [Thread-1 (]: 1 of 3 OK created sql table model DWH.dimCountry ............................... [[32mOK[0m in 2.62s]
[0m15:34:22.932852 [debug] [Thread-1 (]: Finished running node model.online_retail_project.dimCountry
[0m15:34:22.932852 [debug] [Thread-1 (]: Began running node model.online_retail_project.dimCustomer
[0m15:34:22.932852 [info ] [Thread-1 (]: 2 of 3 START sql table model DWH.dimCustomer ................................... [RUN]
[0m15:34:22.932852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_retail_project.dimCountry, now model.online_retail_project.dimCustomer)
[0m15:34:22.932852 [debug] [Thread-1 (]: Began compiling node model.online_retail_project.dimCustomer
[0m15:34:22.941540 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_retail_project.dimCustomer"
[0m15:34:22.944724 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dimCustomer (compile): 15:34:22.932852 => 15:34:22.943654
[0m15:34:22.945702 [debug] [Thread-1 (]: Began executing node model.online_retail_project.dimCustomer
[0m15:34:22.946779 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCustomer"
[0m15:34:22.946779 [debug] [Thread-1 (]: On model.online_retail_project.dimCustomer: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCustomer"} */

      
      
    USE [online-retail-kaggle];
    EXEC('DROP table IF EXISTS "DWH"."dimCustomer__dbt_backup";');

[0m15:34:22.946779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:22.946779 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m15:34:22.952805 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m15:34:23.183182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:23.183182 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCustomer"
[0m15:34:23.183182 [debug] [Thread-1 (]: On model.online_retail_project.dimCustomer: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCustomer"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH'
    and table_name like 'dimCustomer'
  
[0m15:34:23.424944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:23.424944 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCustomer"
[0m15:34:23.424944 [debug] [Thread-1 (]: On model.online_retail_project.dimCustomer: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCustomer"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH'
      and refs.referenced_entity_name = 'dimCustomer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:34:23.674483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:23.674483 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCustomer"
[0m15:34:23.674483 [debug] [Thread-1 (]: On model.online_retail_project.dimCustomer: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCustomer"} */

    
      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH"."dimCustomer_temp_view";');

  
[0m15:34:23.906726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:23.909237 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCustomer"
[0m15:34:23.909237 [debug] [Thread-1 (]: On model.online_retail_project.dimCustomer: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCustomer"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH'
      and refs.referenced_entity_name = 'dimCustomer_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:34:24.140984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:24.143987 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_retail_project.dimCustomer"
[0m15:34:24.143987 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimCustomer"
[0m15:34:24.143987 [debug] [Thread-1 (]: On model.online_retail_project.dimCustomer: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimCustomer"} */

  
    

   

    USE [online-retail-kaggle];
    
    

    EXEC('create view "DWH"."dimCustomer_temp_view" as 

SELECT DISTINCT CustomerID, Country
FROM "online-retail-kaggle"."STG"."retail_sales"
WHERE CustomerID IS NOT NULL;');



    
      EXEC('SELECT * INTO [online-retail-kaggle].[DWH].[dimCustomer] FROM [online-retail-kaggle].[DWH].[dimCustomer_temp_view];');
    

    
      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH"."dimCustomer_temp_view";');



  
[0m15:34:24.379571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:24.379571 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dimCustomer (execute): 15:34:22.946326 => 15:34:24.379571
[0m15:34:24.379571 [debug] [Thread-1 (]: On model.online_retail_project.dimCustomer: ROLLBACK
[0m15:34:24.383123 [debug] [Thread-1 (]: On model.online_retail_project.dimCustomer: Close
[0m15:34:24.383277 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_retail_project\models\transform\dimCustomer.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online-retail-kaggle.STG.retail_sales'. (208) (SQLMoreResults)")
[0m15:34:24.473102 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online-retail-kaggle.STG.retail_sales'. (208) (SQLMoreResults)")

[0m15:34:24.474773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C148B0EC10>]}
[0m15:34:24.474773 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model DWH.dimCustomer .......................... [[31mERROR[0m in 1.54s]
[0m15:34:24.476844 [debug] [Thread-1 (]: Finished running node model.online_retail_project.dimCustomer
[0m15:34:24.476844 [debug] [Thread-1 (]: Began running node model.online_retail_project.dimProducts
[0m15:34:24.476844 [info ] [Thread-1 (]: 3 of 3 START sql table model DWH.dimProducts ................................... [RUN]
[0m15:34:24.476844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_retail_project.dimCustomer, now model.online_retail_project.dimProducts)
[0m15:34:24.476844 [debug] [Thread-1 (]: Began compiling node model.online_retail_project.dimProducts
[0m15:34:24.482983 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_retail_project.dimProducts"
[0m15:34:24.482983 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dimProducts (compile): 15:34:24.482983 => 15:34:24.482983
[0m15:34:24.482983 [debug] [Thread-1 (]: Began executing node model.online_retail_project.dimProducts
[0m15:34:24.482983 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimProducts"
[0m15:34:24.493755 [debug] [Thread-1 (]: On model.online_retail_project.dimProducts: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimProducts"} */

      
      
    USE [online-retail-kaggle];
    EXEC('DROP table IF EXISTS "DWH"."dimProducts__dbt_backup";');

[0m15:34:24.494429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:24.494429 [debug] [Thread-1 (]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=online-retail.database.windows.net,1433;Database=online-retail-kaggle;UID={adminsql};PWD=***;encrypt=Yes;TrustServerCertificate=No;Application Name=dbt-sqlserver/1.7.4
[0m15:34:24.495451 [debug] [Thread-1 (]: SQLServer adapter: Connected to db: online-retail-kaggle
[0m15:34:24.722873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:24.722873 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimProducts"
[0m15:34:24.722873 [debug] [Thread-1 (]: On model.online_retail_project.dimProducts: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimProducts"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'DWH'
    and table_name like 'dimProducts'
  
[0m15:34:24.963799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:24.973307 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimProducts"
[0m15:34:24.973307 [debug] [Thread-1 (]: On model.online_retail_project.dimProducts: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimProducts"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH'
      and refs.referenced_entity_name = 'dimProducts_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:34:25.221484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:25.221484 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimProducts"
[0m15:34:25.223144 [debug] [Thread-1 (]: On model.online_retail_project.dimProducts: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimProducts"} */

    
      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH"."dimProducts_temp_view";');

  
[0m15:34:25.453351 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:25.453351 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimProducts"
[0m15:34:25.453351 [debug] [Thread-1 (]: On model.online_retail_project.dimProducts: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimProducts"} */

      USE [online-retail-kaggle];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'online-retail-kaggle'
      and refs.referenced_schema_name = 'DWH'
      and refs.referenced_entity_name = 'dimProducts_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m15:34:25.691708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:25.693280 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_retail_project.dimProducts"
[0m15:34:25.695553 [debug] [Thread-1 (]: Using sqlserver connection "model.online_retail_project.dimProducts"
[0m15:34:25.697290 [debug] [Thread-1 (]: On model.online_retail_project.dimProducts: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "online_retail_project", "target_name": "dwh", "node_id": "model.online_retail_project.dimProducts"} */

  
    

   

    USE [online-retail-kaggle];
    
    

    EXEC('create view "DWH"."dimProducts_temp_view" as 

SELECT DISTINCT StockCode, Description, UnitPrice, 
       CONVERT(BIGINT, HASHBYTES(''SHA2_256'', @StockCode)) AS Product_key
FROM "online-retail-kaggle"."STG"."retail_sales"
WHERE StockCode IS NOT NULL;');



    
      EXEC('SELECT * INTO [online-retail-kaggle].[DWH].[dimProducts] FROM [online-retail-kaggle].[DWH].[dimProducts_temp_view];');
    

    
      
      
    
    USE [online-retail-kaggle];
    EXEC('DROP view IF EXISTS "DWH"."dimProducts_temp_view";');



  
[0m15:34:25.937293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:25.940188 [debug] [Thread-1 (]: Timing info for model.online_retail_project.dimProducts (execute): 15:34:24.482983 => 15:34:25.939182
[0m15:34:25.941695 [debug] [Thread-1 (]: On model.online_retail_project.dimProducts: ROLLBACK
[0m15:34:25.941695 [debug] [Thread-1 (]: On model.online_retail_project.dimProducts: Close
[0m15:34:25.942753 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\online_retail_project\models\transform\dimProducts.sql[0m
('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Must declare the scalar variable "@StockCode". (137) (SQLMoreResults)')
[0m15:34:25.946270 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\base.py", line 427, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 83, in macro
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\clients\jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\adapters\base\impl.py", line 310, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thanh Phat\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 499, in execute
    while cursor.nextset():
          ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Must declare the scalar variable "@StockCode". (137) (SQLMoreResults)')

[0m15:34:25.946270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21d08937-9dda-4dd9-aa83-93b75184ec0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C149D50290>]}
[0m15:34:25.946270 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model DWH.dimProducts .......................... [[31mERROR[0m in 1.47s]
[0m15:34:25.952243 [debug] [Thread-1 (]: Finished running node model.online_retail_project.dimProducts
[0m15:34:25.953431 [debug] [MainThread]: On master: COMMIT
[0m15:34:25.954780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:25.955292 [debug] [MainThread]: Connection 'list_online-retail-kaggle' was properly closed.
[0m15:34:25.956298 [debug] [MainThread]: Connection 'list_online-retail-kaggle_DWH' was properly closed.
[0m15:34:25.957048 [debug] [MainThread]: Connection 'model.online_retail_project.dimProducts' was properly closed.
[0m15:34:25.957778 [info ] [MainThread]: 
[0m15:34:25.958046 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.28 seconds (8.28s).
[0m15:34:25.958046 [debug] [MainThread]: Command end result
[0m15:34:26.012751 [info ] [MainThread]: 
[0m15:34:26.012751 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:34:26.012751 [info ] [MainThread]: 
[0m15:34:26.012751 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid object name 'online-retail-kaggle.STG.retail_sales'. (208) (SQLMoreResults)")
[0m15:34:26.012751 [info ] [MainThread]: 
[0m15:34:26.012751 [error] [MainThread]:   ('42000', '[42000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Must declare the scalar variable "@StockCode". (137) (SQLMoreResults)')
[0m15:34:26.023711 [info ] [MainThread]: 
[0m15:34:26.025324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m15:34:26.026784 [debug] [MainThread]: Command `dbt run` failed at 15:34:26.026784 after 9.40 seconds
[0m15:34:26.026784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C147C68090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C141690750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C141690850>]}
[0m15:34:26.026784 [debug] [MainThread]: Flushing usage events
